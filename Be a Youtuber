-- ============================================================
--  LUNAMOON HUB v2.6 - Ultimate Edition (English, Animated, Floors & Codes)
-- ============================================================

-- CLEANUP
if game.CoreGui:FindFirstChild("LunaMoonHub") then
    game.CoreGui:FindFirstChild("LunaMoonHub"):Destroy()
end

-- SERVICES
local Players           = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService      = game:GetService("TweenService")
local UserInputService  = game:GetService("UserInputService")
local RunService        = game:GetService("RunService")

local player = Players.LocalPlayer
local events = ReplicatedStorage:WaitForChild("events")

-- ============================================================
--  GLOBALS
-- ============================================================
_G.AutoCollect      = false
_G.AutoUpload       = false
_G.AutoClaim        = false
_G.AutoSubmit       = false
_G.AutoUpgrades     = false
_G.AutoBuyHouse     = false
_G.AutoBuy          = false
_G.AutoBulkHatch    = false
_G.AutoFloorCycle   = false
_G.SmartAutoRebirth = false
_G.SelectedYoutuber = ""
_G.WalkSpeed        = 16

-- ============================================================
--  MONOCHROME PALETTE
-- ============================================================
local C = {
    bg         = Color3.fromRGB(15, 15, 15),
    sidebar    = Color3.fromRGB(20, 20, 20),
    panel      = Color3.fromRGB(25, 25, 25),
    card       = Color3.fromRGB(30, 30, 30),
    cardHover  = Color3.fromRGB(45, 45, 45),
    accent     = Color3.fromRGB(255, 255, 255),
    accentGlow = Color3.fromRGB(150, 150, 150),
    text       = Color3.fromRGB(240, 240, 240),
    subtext    = Color3.fromRGB(130, 130, 130),
    toggleOn   = Color3.fromRGB(255, 255, 255),
    toggleOff  = Color3.fromRGB(60, 60, 60),
    white      = Color3.fromRGB(255, 255, 255),
    divider    = Color3.fromRGB(40, 40, 40),
}

-- ============================================================
--  HELPERS
-- ============================================================
local function corner(parent, radius)
    local c = Instance.new("UICorner", parent)
    c.CornerRadius = UDim.new(0, radius or 10)
    return c
end

local function stroke(parent, color, thickness)
    local s = Instance.new("UIStroke", parent)
    s.Color        = color or C.accentGlow
    s.Thickness    = thickness or 1
    s.Transparency = 0.55
    return s
end

-- ANIMATED GRADIENT STROKE
local function animatedStroke(parent, thickness)
    local s = Instance.new("UIStroke", parent)
    s.Color = Color3.fromRGB(255, 255, 255)
    s.Thickness = thickness or 1.5
    s.Transparency = 0.1
    
    local grad = Instance.new("UIGradient", s)
    grad.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),   -- White
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(120, 120, 120)), -- Gray
        ColorSequenceKeypoint.new(1, Color3.fromRGB(10, 10, 10))       -- Black
    })
    
    task.spawn(function()
        local rotation = 0
        RunService.Heartbeat:Connect(function(dt)
            rotation = (rotation + dt * 45) % 360
            grad.Rotation = rotation
        end)
    end)
    
    return s
end

local function tween(obj, props, t, style, dir)
    TweenService:Create(
        obj,
        TweenInfo.new(t or 0.2, style or Enum.EasingStyle.Quart, dir or Enum.EasingDirection.Out),
        props
    ):Play()
end

local function applyPadding(parent, top, bottom, left, right)
    local p = Instance.new("UIPadding", parent)
    p.PaddingTop    = UDim.new(0, top    or 0)
    p.PaddingBottom = UDim.new(0, bottom or 0)
    p.PaddingLeft   = UDim.new(0, left   or 0)
    p.PaddingRight  = UDim.new(0, right  or 0)
end

-- ============================================================
--  ROOT GUI
-- ============================================================
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name            = "LunaMoonHub"
ScreenGui.ResetOnSpawn    = false
ScreenGui.ZIndexBehavior  = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent          = game.CoreGui

-- ============================================================
--  MAIN WINDOW
-- ============================================================
local Win = Instance.new("Frame", ScreenGui)
Win.Name             = "MainWindow"
Win.AnchorPoint      = Vector2.new(0.5, 0.5)
Win.Position         = UDim2.new(0.5, 0, 0.5, 0)
Win.Size             = UDim2.new(0, 560, 0, 400)
Win.BackgroundColor3 = C.bg
Win.BorderSizePixel  = 0
Win.Active           = true
Win.Draggable        = true
Win.ClipsDescendants = false
corner(Win, 14)
animatedStroke(Win, 1.5)

-- SHADOW
local Shadow = Instance.new("ImageLabel", Win)
Shadow.Name                 = "Shadow"
Shadow.ZIndex               = -1
Shadow.AnchorPoint          = Vector2.new(0.5, 0.5)
Shadow.BackgroundTransparency = 1
Shadow.Position             = UDim2.new(0.5, 0, 0.5, 4)
Shadow.Size                 = UDim2.new(1, 50, 1, 30)
Shadow.Image                = "rbxassetid://6015897843"
Shadow.ImageColor3          = Color3.fromRGB(0, 0, 0)
Shadow.ImageTransparency    = 0.45
Shadow.ScaleType            = Enum.ScaleType.Slice
Shadow.SliceCenter          = Rect.new(49, 49, 450, 450)

-- ============================================================
--  TOPBAR
-- ============================================================
local TopBar = Instance.new("Frame", Win)
TopBar.Size             = UDim2.new(1, 0, 0, 46)
TopBar.BackgroundColor3 = C.sidebar
TopBar.BorderSizePixel  = 0
TopBar.ZIndex           = 2

local TopCorner = Instance.new("UICorner", TopBar)
TopCorner.CornerRadius = UDim.new(0, 14)

local TopPatch = Instance.new("Frame", TopBar)
TopPatch.Size             = UDim2.new(1, 0, 0, 14)
TopPatch.Position         = UDim2.new(0, 0, 1, -14)
TopPatch.BackgroundColor3 = C.sidebar
TopPatch.BorderSizePixel  = 0
TopPatch.ZIndex           = 2

-- TOP LOGO (Optional, keeping it based on previous script)
local Logo = Instance.new("ImageLabel", TopBar)
Logo.Size                 = UDim2.new(0, 28, 0, 28)
Logo.Position             = UDim2.new(0, 12, 0.5, -14)
Logo.BackgroundTransparency = 1
Logo.Image                = "rbxassetid://129928619995803"
Logo.ImageColor3          = C.accent
Logo.ZIndex               = 3

local TopTitle = Instance.new("TextLabel", TopBar)
TopTitle.Position         = UDim2.new(0, 48, 0, 5)
TopTitle.Size             = UDim2.new(0, 250, 0, 20)
TopTitle.BackgroundTransparency = 1
TopTitle.Text             = "LunaMoon Hub"
TopTitle.TextColor3       = C.white
TopTitle.Font             = Enum.Font.GothamBold
TopTitle.TextSize         = 15
TopTitle.TextXAlignment   = Enum.TextXAlignment.Left
TopTitle.ZIndex           = 3

local TopSub = Instance.new("TextLabel", TopBar)
TopSub.Position           = UDim2.new(0, 48, 0, 26)
TopSub.Size               = UDim2.new(0, 250, 0, 14)
TopSub.BackgroundTransparency = 1
TopSub.Text               = "Be a Youtuber (F8 to Hide)"
TopSub.TextColor3         = C.subtext
TopSub.Font               = Enum.Font.Gotham
TopSub.TextSize           = 11
TopSub.TextXAlignment     = Enum.TextXAlignment.Left
TopSub.ZIndex             = 3

local CloseBtn = Instance.new("TextButton", TopBar)
CloseBtn.Name             = "CloseBtn"
CloseBtn.ZIndex           = 10
CloseBtn.Size             = UDim2.new(0, 28, 0, 28)
CloseBtn.Position         = UDim2.new(1, -38, 0.5, -14)
CloseBtn.BackgroundColor3 = C.card
CloseBtn.Text             = "X"
CloseBtn.TextColor3       = C.white
CloseBtn.Font             = Enum.Font.GothamBold
CloseBtn.TextSize         = 13
CloseBtn.BorderSizePixel  = 0
corner(CloseBtn, 7)
CloseBtn.MouseEnter:Connect(function() tween(CloseBtn, { BackgroundColor3 = C.cardHover }) end)
CloseBtn.MouseLeave:Connect(function() tween(CloseBtn, { BackgroundColor3 = C.card }) end)

local MinBtn = Instance.new("TextButton", TopBar)
MinBtn.ZIndex             = 10
MinBtn.Size               = UDim2.new(0, 28, 0, 28)
MinBtn.Position           = UDim2.new(1, -72, 0.5, -14)
MinBtn.BackgroundColor3   = C.card
MinBtn.Text               = "-"
MinBtn.TextColor3         = C.white
MinBtn.Font               = Enum.Font.GothamBold
MinBtn.TextSize           = 16
MinBtn.BorderSizePixel    = 0
corner(MinBtn, 7)
MinBtn.MouseEnter:Connect(function() tween(MinBtn, { BackgroundColor3 = C.cardHover }) end)
MinBtn.MouseLeave:Connect(function() tween(MinBtn, { BackgroundColor3 = C.card }) end)

-- ============================================================
--  BODY
-- ============================================================
local Body = Instance.new("Frame", Win)
Body.Position            = UDim2.new(0, 0, 0, 46)
Body.Size                = UDim2.new(1, 0, 1, -46)
Body.BackgroundTransparency = 1
Body.BorderSizePixel     = 0
Body.ClipsDescendants    = true

-- ============================================================
--  SIDEBAR
-- ============================================================
local Sidebar = Instance.new("Frame", Body)
Sidebar.Size             = UDim2.new(0, 130, 1, 0)
Sidebar.Position         = UDim2.new(0, 0, 0, 0)
Sidebar.BackgroundColor3 = C.sidebar
Sidebar.BorderSizePixel  = 0
corner(Sidebar, 14)

local SidePatchTop = Instance.new("Frame", Body)
SidePatchTop.Size             = UDim2.new(0, 130, 0, 14)
SidePatchTop.Position         = UDim2.new(0, 0, 0, 0)
SidePatchTop.BackgroundColor3 = C.sidebar
SidePatchTop.BorderSizePixel  = 0

local SidePatchBR = Instance.new("Frame", Body)
SidePatchBR.Size             = UDim2.new(0, 14, 0, 14)
SidePatchBR.Position         = UDim2.new(0, 116, 1, -14)
SidePatchBR.BackgroundColor3 = C.sidebar
SidePatchBR.BorderSizePixel  = 0

local VDivider = Instance.new("Frame", Body)
VDivider.Position        = UDim2.new(0, 130, 0, 0)
VDivider.Size            = UDim2.new(0, 1, 1, 0)
VDivider.BackgroundColor3 = C.divider
VDivider.BorderSizePixel = 0
VDivider.ZIndex          = 2

local SideList = Instance.new("UIListLayout", Sidebar)
SideList.Padding              = UDim.new(0, 4)
SideList.SortOrder            = Enum.SortOrder.LayoutOrder
SideList.HorizontalAlignment  = Enum.HorizontalAlignment.Center
SideList.VerticalAlignment    = Enum.VerticalAlignment.Top
applyPadding(Sidebar, 12, 12, 8, 8)

-- SIDEBAR LOGO
local SideLogoContainer = Instance.new("Frame", Sidebar)
SideLogoContainer.Size = UDim2.new(1, 0, 0, 80)
SideLogoContainer.BackgroundTransparency = 1
SideLogoContainer.LayoutOrder = -1 -- Forces it to the very top

local SideLogo = Instance.new("ImageLabel", SideLogoContainer)
SideLogo.Size = UDim2.new(0, 64, 0, 64)
SideLogo.Position = UDim2.new(0.5, 0, 0.5, 0)
SideLogo.AnchorPoint = Vector2.new(0.5, 0.5)
SideLogo.BackgroundTransparency = 1
SideLogo.Image = "rbxassetid://131711664935136"

local SideVer = Instance.new("TextLabel", Sidebar)
SideVer.Size               = UDim2.new(1, 0, 0, 14)
SideVer.BackgroundTransparency = 1
SideVer.Text               = "v2.6"
SideVer.TextColor3         = C.subtext
SideVer.Font               = Enum.Font.Gotham
SideVer.TextSize           = 10
SideVer.TextXAlignment     = Enum.TextXAlignment.Center
SideVer.LayoutOrder        = 999

-- ============================================================
--  CONTENT AREA
-- ============================================================
local Content = Instance.new("Frame", Body)
Content.Position         = UDim2.new(0, 131, 0, 0)
Content.Size             = UDim2.new(1, -131, 1, 0)
Content.BackgroundTransparency = 1
Content.BorderSizePixel  = 0
Content.ClipsDescendants = true

-- ============================================================
--  TAB FACTORY
-- ============================================================
local tabs = {}

local TAB_DEFS = {
    { name = "Automation", icon = "âš¡" },
    { name = "Speed",      icon = "ðŸš€" },
    { name = "Floor",      icon = "ðŸ—º"  },
    { name = "Info",       icon = "â„¹"  },
}

local function makeTabPage(name)
    local page = Instance.new("ScrollingFrame", Content)
    page.Name                 = name
    page.Size                 = UDim2.new(1, 0, 1, 0)
    page.Position             = UDim2.new(0, 0, 0, 0)
    page.BackgroundTransparency = 1
    page.ScrollBarThickness   = 3
    page.ScrollBarImageColor3 = C.accentGlow
    page.CanvasSize           = UDim2.new(0, 0, 0, 0)
    page.AutomaticCanvasSize  = Enum.AutomaticSize.Y
    page.BorderSizePixel      = 0
    page.Visible              = false

    local list = Instance.new("UIListLayout", page)
    list.Padding             = UDim.new(0, 6)
    list.SortOrder           = Enum.SortOrder.LayoutOrder
    list.HorizontalAlignment = Enum.HorizontalAlignment.Center

    applyPadding(page, 10, 10, 10, 10)
    return page, list
end

local function makeTabBtn(def, index)
    local btn = Instance.new("TextButton", Sidebar)
    btn.Name                 = def.name
    btn.LayoutOrder          = index
    btn.Size                 = UDim2.new(1, 0, 0, 38)
    btn.BackgroundColor3     = C.card
    btn.BackgroundTransparency = 1
    btn.Text                 = def.icon .. "  " .. def.name
    btn.TextColor3           = C.subtext
    btn.Font                 = Enum.Font.GothamSemibold
    btn.TextSize             = 12
    btn.TextXAlignment       = Enum.TextXAlignment.Left
    btn.BorderSizePixel      = 0
    corner(btn, 8)
    applyPadding(btn, 0, 0, 10, 0)
    return btn
end

local function switchTab(name)
    for tabName, t in pairs(tabs) do
        local on = tabName == name
        t.page.Visible = on
        tween(t.btn, {
            TextColor3           = on and C.white or C.subtext,
            BackgroundTransparency = on and 0 or 1,
        })
        if on then t.btn.BackgroundColor3 = C.card end
    end
end

for i, def in ipairs(TAB_DEFS) do
    local page, list = makeTabPage(def.name)
    local btn        = makeTabBtn(def, i)
    tabs[def.name]   = { page = page, list = list, btn = btn }
    btn.MouseButton1Click:Connect(function() switchTab(def.name) end)
end

local autoPage  = tabs["Automation"].page
local speedPage = tabs["Speed"].page
local floorPage = tabs["Floor"].page
local infoPage  = tabs["Info"].page

-- ============================================================
--  REUSABLE COMPONENTS
-- ============================================================
local function sectionLabel(parent, text, order)
    local f = Instance.new("Frame", parent)
    f.LayoutOrder          = order or 0
    f.Size                 = UDim2.new(1, 0, 0, 22)
    f.BackgroundTransparency = 1

    local lbl = Instance.new("TextLabel", f)
    lbl.Size               = UDim2.new(1, 0, 1, 0)
    lbl.BackgroundTransparency = 1
    lbl.Text               = text
    lbl.TextColor3         = C.accentGlow
    lbl.Font               = Enum.Font.GothamBold
    lbl.TextSize           = 11
    lbl.TextXAlignment     = Enum.TextXAlignment.Left
    return f
end

local function makeToggle(parent, text, order, callback)
    local btn = Instance.new("TextButton", parent)
    btn.LayoutOrder        = order
    btn.Size               = UDim2.new(1, 0, 0, 38)
    btn.BackgroundColor3   = C.card
    btn.Text               = "   " .. text
    btn.TextColor3         = C.text
    btn.Font               = Enum.Font.GothamSemibold
    btn.TextSize           = 13
    btn.TextXAlignment     = Enum.TextXAlignment.Left
    btn.BorderSizePixel    = 0
    corner(btn, 9)
    stroke(btn, C.divider, 1)

    local dot = Instance.new("Frame", btn)
    dot.Size               = UDim2.new(0, 8, 0, 8)
    dot.Position           = UDim2.new(1, -18, 0.5, -4)
    dot.BackgroundColor3   = C.toggleOff
    dot.BorderSizePixel    = 0
    corner(dot, 8)

    local active = false
    btn.MouseButton1Click:Connect(function()
        active = not active
        tween(dot,  { BackgroundColor3 = active and C.toggleOn or C.toggleOff })
        tween(btn,  {
            BackgroundColor3 = active and Color3.fromRGB(40, 40, 40) or C.card,
            TextColor3       = active and C.white or C.text,
        })
        callback(btn, active)
    end)

    btn.MouseEnter:Connect(function()
        if not active then tween(btn, { BackgroundColor3 = C.cardHover }) end
    end)
    btn.MouseLeave:Connect(function()
        if not active then tween(btn, { BackgroundColor3 = C.card }) end
    end)

    return btn
end

local function makeActionBtn(parent, text, order, callback)
    local btn = Instance.new("TextButton", parent)
    btn.LayoutOrder        = order
    btn.Size               = UDim2.new(1, 0, 0, 38)
    btn.BackgroundColor3   = C.card
    btn.Text               = text
    btn.TextColor3         = C.accent
    btn.Font               = Enum.Font.GothamBold
    btn.TextSize           = 13
    btn.BorderSizePixel    = 0
    corner(btn, 9)
    stroke(btn, C.divider, 1)

    btn.MouseButton1Click:Connect(callback)
    btn.MouseEnter:Connect(function() tween(btn, { BackgroundColor3 = C.cardHover }) end)
    btn.MouseLeave:Connect(function() tween(btn, { BackgroundColor3 = C.card }) end)
    return btn
end

local function makeInput(parent, placeholder, order)
    local box = Instance.new("TextBox", parent)
    box.LayoutOrder           = order
    box.Size                  = UDim2.new(1, 0, 0, 36)
    box.BackgroundColor3      = C.card
    box.PlaceholderText       = "  " .. placeholder
    box.PlaceholderColor3     = C.subtext
    box.Text                  = ""
    box.TextColor3            = C.text
    box.Font                  = Enum.Font.GothamSemibold
    box.TextSize              = 13
    box.TextXAlignment        = Enum.TextXAlignment.Left
    box.BorderSizePixel       = 0
    box.ClearTextOnFocus      = false
    corner(box, 9)
    stroke(box, C.divider, 1)
    return box
end

-- ============================================================
--  TAB : AUTOMATION
-- ============================================================
sectionLabel(autoPage, "COLLECT & UPLOAD", 0)

makeToggle(autoPage, "Auto Collect", 1, function(_, state)
    _G.AutoCollect = state
    if state then task.spawn(function()
        while _G.AutoCollect do
            for _, p in pairs(workspace.Plots:GetChildren()) do
                local builds = p:FindFirstChild("Builds")
                if builds then
                    for _, item in pairs(builds:GetDescendants()) do
                        if _G.AutoCollect and item:IsA("TouchTransmitter") then
                            local part = item.Parent
                            if part and part:IsA("BasePart") then
                                firetouchinterest(player.Character.HumanoidRootPart, part, 0)
                                task.wait(0.05)
                                firetouchinterest(player.Character.HumanoidRootPart, part, 1)
                            end
                        end
                    end
                end
            end
            task.wait(0.8)
        end
    end) end
end)

makeToggle(autoPage, "Auto Upload", 2, function(_, state)
    _G.AutoUpload = state
    if state then task.spawn(function()
        while _G.AutoUpload do
            pcall(function() events.uploadAll:FireServer() end)
            task.wait(3)
        end
    end) end
end)

makeToggle(autoPage, "Auto Claim", 3, function(_, state)
    _G.AutoClaim = state
    if state then task.spawn(function()
        while _G.AutoClaim do
            pcall(function() events.claimAll:FireServer() end)
            task.wait(3)
        end
    end) end
end)

makeToggle(autoPage, "Auto Submit", 4, function(_, state)
    _G.AutoSubmit = state
    if state then task.spawn(function()
        while _G.AutoSubmit do
            pcall(function() events.submitAll:FireServer() end)
            task.wait(3)
        end
    end) end
end)

sectionLabel(autoPage, "REBIRTH & UPGRADES", 10)

makeToggle(autoPage, "Smart Auto Rebirth", 11, function(_, state)
    _G.SmartAutoRebirth = state
    if state then task.spawn(function()
        local rebirthMenu = player.PlayerGui.ScreenGui.menus.rebirthMenu
        local cont = rebirthMenu.container
        while _G.SmartAutoRebirth do
            local cash = player.leaderstats.Cash.Value
            local bestAmount, bestButton = 0, nil
            for _, b in pairs(cont:GetChildren()) do
                if b:IsA("TextButton") then
                    local amount = tonumber((b.rebirths.Text or ""):match("%+(%d+)"))
                    local cost   = tonumber((b.cost.Text or ""):match("%$(%d+)"))
                    if amount and cost and cash >= cost and amount > bestAmount then
                        bestAmount = amount
                        bestButton = b
                    end
                end
            end
            if bestButton then
                pcall(function() events.rebirth:FireServer(bestAmount) end)
            end
            task.wait(1)
        end
    end) end
end)

makeToggle(autoPage, "Auto Upgrades", 12, function(_, state)
    _G.AutoUpgrades = state
    local upgradeList = {"views","luck","viralChance","rebirthButtons","uploadTime"}
    if state then task.spawn(function()
        while _G.AutoUpgrades do
            for _, upg in pairs(upgradeList) do
                if not _G.AutoUpgrades then break end
                pcall(function() events.buyUpgrade:FireServer(upg) end)
                task.wait(1)
            end
            task.wait(5)
        end
    end) end
end)

makeToggle(autoPage, "Auto Buy House", 13, function(_, state)
    _G.AutoBuyHouse = state
    if state then task.spawn(function()
        while _G.AutoBuyHouse do
            pcall(function() events.buyHouse:FireServer(player) end)
            task.wait(2)
        end
    end) end
end)

sectionLabel(autoPage, "YOUTUBERS", 20)

local inputYT = makeInput(autoPage, "Enter Youtuber ID...", 21)
inputYT:GetPropertyChangedSignal("Text"):Connect(function()
    _G.SelectedYoutuber = inputYT.Text
end)

makeToggle(autoPage, "Auto Buy Youtuber", 22, function(_, state)
    _G.AutoBuy = state
    if state then task.spawn(function()
        while _G.AutoBuy do
            if _G.SelectedYoutuber ~= "" then
                pcall(function() events.buyYoutuber:FireServer(_G.SelectedYoutuber) end)
            end
            task.wait(2)
        end
    end) end
end)

makeActionBtn(autoPage, "âš   Sell All Youtubers", 23, function()
    pcall(function() events.sellAll:FireServer() end)
end)

sectionLabel(autoPage, "EGGS", 30)

makeToggle(autoPage, "Auto Bulk Hatch", 31, function(_, state)
    _G.AutoBulkHatch = state
    if state then task.spawn(function()
        local BATCH = 10000
        local cratesLabel = player
            :WaitForChild("PlayerGui")
            :WaitForChild("ScreenGui")
            :WaitForChild("menus")
            :WaitForChild("eventMenu")
            :WaitForChild("balance")
            :WaitForChild("crates")
        local openEventEgg = ReplicatedStorage
            :WaitForChild("events")
            :WaitForChild("openEventEgg")
        while _G.AutoBulkHatch do
            local n = tonumber((cratesLabel.Text or ""):match("%d+")) or 0
            if n > 0 then
                openEventEgg:FireServer(math.min(n, BATCH))
            end
            task.wait(1)
        end
    end) end
end)

sectionLabel(autoPage, "PROMO CODES", 40)

local knownCodes = {
    "release", "secretcode", "20klikes", "30klikes", 
    "50klikes", "100klikes", "mutations", "200klikes"
}

makeActionBtn(autoPage, "ðŸŽ Redeem All Codes", 41, function()
    if not player:IsInGroup(476287845) then
        warn("[LunaMoon] WARNING: You must join the game's Roblox group for codes to work!")
    end
    
    task.spawn(function()
        for _, code in ipairs(knownCodes) do
            local safeCode = string.lower(code)
            pcall(function()
                events.redeemCode:FireServer(safeCode)
            end)
            task.wait(0.5)
        end
        print("[LunaMoon] All codes have been sent to the server!")
    end)
end)

task.spawn(function()
    task.wait(3)
    for _, name in ipairs({"hatchExclusiveEgg","hatchEventEgg","hatchPet","showEgg","eggAnimation"}) do
        local ev = events:FindFirstChild(name)
        if ev and ev.OnClientEvent then
            for _, conn in pairs(getconnections(ev.OnClientEvent)) do
                conn:Disconnect()
            end
        end
    end
end)

-- ============================================================
--  TAB : SPEED
-- ============================================================
sectionLabel(speedPage, "CHARACTER SPEED", 0)

local speedDisplay = Instance.new("TextLabel", speedPage)
speedDisplay.LayoutOrder       = 1
speedDisplay.Size              = UDim2.new(1, 0, 0, 50)
speedDisplay.BackgroundColor3  = C.card
speedDisplay.TextColor3        = C.white
speedDisplay.Font              = Enum.Font.GothamBold
speedDisplay.TextSize          = 24
speedDisplay.Text              = "âš¡  Speed: 16"
speedDisplay.BorderSizePixel   = 0
corner(speedDisplay, 9)
stroke(speedDisplay, C.divider, 1)

local jumpDisplay = Instance.new("TextLabel", speedPage)
jumpDisplay.LayoutOrder        = 6
jumpDisplay.Size               = UDim2.new(1, 0, 0, 50)
jumpDisplay.BackgroundColor3   = C.card
jumpDisplay.TextColor3         = C.white
jumpDisplay.Font               = Enum.Font.GothamBold
jumpDisplay.TextSize           = 24
jumpDisplay.Text               = "â†‘  Jump: 50"
jumpDisplay.BorderSizePixel    = 0
corner(jumpDisplay, 9)
stroke(jumpDisplay, C.divider, 1)

local function applySpeed(val)
    _G.WalkSpeed = val
    speedDisplay.Text = "âš¡  Speed: " .. val
    pcall(function() player.Character.Humanoid.WalkSpeed = val end)
end

local function applyJump(val)
    jumpDisplay.Text = "â†‘  Jump: " .. val
    pcall(function() player.Character.Humanoid.JumpPower = val end)
end

local function makePresetsRow(parent, order, presets, applyFn)
    local row = Instance.new("Frame", parent)
    row.LayoutOrder        = order
    row.Size               = UDim2.new(1, 0, 0, 38)
    row.BackgroundTransparency = 1
    row.BorderSizePixel    = 0

    local grid = Instance.new("UIGridLayout", row)
    grid.CellSize          = UDim2.new(0, 86, 0, 34)
    grid.CellPadding       = UDim2.new(0, 5, 0, 0)
    grid.SortOrder         = Enum.SortOrder.LayoutOrder
    grid.HorizontalAlignment = Enum.HorizontalAlignment.Center
    grid.FillDirectionMaxCells = #presets

    for _, v in ipairs(presets) do
        local pb = Instance.new("TextButton", row)
        pb.BackgroundColor3 = C.card
        pb.Text             = tostring(v)
        pb.TextColor3       = C.accent
        pb.Font             = Enum.Font.GothamBold
        pb.TextSize         = 13
        pb.BorderSizePixel  = 0
        corner(pb, 8)
        stroke(pb, C.divider, 1)
        pb.MouseButton1Click:Connect(function() applyFn(v) end)
        pb.MouseEnter:Connect(function() tween(pb, {BackgroundColor3 = C.cardHover}) end)
        pb.MouseLeave:Connect(function() tween(pb, {BackgroundColor3 = C.card}) end)
    end
    return row
end

makePresetsRow(speedPage, 2, {16, 50, 100, 200}, applySpeed)

sectionLabel(speedPage, "CUSTOM SPEED", 3)
local speedInput = makeInput(speedPage, "Value (ex: 150)", 4)
makeActionBtn(speedPage, "âœ“  Apply Speed", 5, function()
    local val = tonumber(speedInput.Text)
    if val and val > 0 and val <= 10000 then applySpeed(val) end
end)

sectionLabel(speedPage, "JUMP POWER", 7)
makePresetsRow(speedPage, 8, {50, 100, 200, 500}, applyJump)

sectionLabel(speedPage, "CUSTOM JUMP", 9)
local jumpInput = makeInput(speedPage, "Value (ex: 200)", 10)
makeActionBtn(speedPage, "âœ“  Apply Jump", 11, function()
    local val = tonumber(jumpInput.Text)
    if val and val > 0 and val <= 10000 then applyJump(val) end
end)

makeActionBtn(speedPage, "â†©  Reset All", 12, function()
    applySpeed(16)
    applyJump(50)
    speedInput.Text = ""
    jumpInput.Text  = ""
end)

-- ============================================================
--  TAB : FLOOR (DYNAMIC FLOOR SCRIPT ARCHITECTURE)
-- ============================================================
local function getMyFloors()
    local tempVals = player:FindFirstChild("tempValues")
    if not tempVals then return {} end
    
    local currentPlot = tempVals:FindFirstChild("currentPlot")
    if currentPlot and type(currentPlot.Value) == "string" and currentPlot.Value ~= "" then
        local plotInstance = workspace:WaitForChild("Plots"):FindFirstChild(currentPlot.Value)
        if plotInstance then
            local building = plotInstance:FindFirstChild("Building")
            if building then
                local floorsFolder = building:FindFirstChild("floors")
                if floorsFolder then
                    local allFloors = floorsFolder:GetChildren()
                    
                    table.sort(allFloors, function(a, b)
                        local posA = a:IsA("Model") and (a.PrimaryPart and a.PrimaryPart.Position.Y or a:GetModelCFrame().Y) or a.Position.Y
                        local posB = b:IsA("Model") and (b.PrimaryPart and b.PrimaryPart.Position.Y or b:GetModelCFrame().Y) or b.Position.Y
                        return posA < posB
                    end)
                    
                    return allFloors
                end
            end
        end
    end
    return {}
end

local function teleportToFloor(index, floorsList)
    local targetFloor = floorsList[index]
    if targetFloor then
        local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if hrp then
            local targetCFrame
            if targetFloor:IsA("Model") then
                targetCFrame = targetFloor.PrimaryPart and targetFloor.PrimaryPart.CFrame or targetFloor:GetModelCFrame()
            elseif targetFloor:IsA("BasePart") then
                targetCFrame = targetFloor.CFrame
            end
            
            if targetCFrame then
                hrp.CFrame = targetCFrame + Vector3.new(0, 3, 0)
            end
        end
    end
end

sectionLabel(floorPage, "AUTO FLOOR CYCLE", 0)

local floorStatus = Instance.new("TextLabel", floorPage)
floorStatus.LayoutOrder        = 1
floorStatus.Size               = UDim2.new(1, 0, 0, 38)
floorStatus.BackgroundColor3   = C.card
floorStatus.TextColor3         = C.subtext
floorStatus.Font               = Enum.Font.GothamSemibold
floorStatus.TextSize           = 13
floorStatus.Text               = "Searching for floors..."
floorStatus.BorderSizePixel    = 0
corner(floorStatus, 9)

makeToggle(floorPage, "Auto Floor Cycle", 2, function(_, state)
    _G.AutoFloorCycle = state
    if state then task.spawn(function()
        while _G.AutoFloorCycle do
            local floors = getMyFloors()
            if #floors > 0 then
                for i = 1, #floors do
                    if not _G.AutoFloorCycle then break end
                    floorStatus.Text = "Current Floor: " .. i .. " / " .. #floors
                    floorStatus.TextColor3 = C.accent
                    pcall(function() teleportToFloor(i, floors) end)
                    task.wait(10)
                end
            else
                floorStatus.Text = "No floors found."
                task.wait(2)
            end
        end
        floorStatus.Text = "Current Floor: â€”"
        floorStatus.TextColor3 = C.subtext
    end) end
end)

sectionLabel(floorPage, "FAST TELEPORT", 5)

for i = 1, 10 do
    makeActionBtn(floorPage, "â†’  Floor " .. i, 10 + i, function()
        local floors = getMyFloors()
        if floors[i] then
            pcall(function() teleportToFloor(i, floors) end)
            floorStatus.Text = "Teleported: Floor " .. i .. " / " .. #floors
            floorStatus.TextColor3 = C.accent
        else
            floorStatus.Text = "Floor " .. i .. " not unlocked!"
            floorStatus.TextColor3 = Color3.fromRGB(200, 50, 50)
        end
    end)
end

-- ============================================================
--  TAB : INFO
-- ============================================================
local function infoCard(parent, order, key, value)
    local card = Instance.new("Frame", parent)
    card.LayoutOrder        = order
    card.Size               = UDim2.new(1, 0, 0, 52)
    card.BackgroundColor3   = C.card
    card.BorderSizePixel    = 0
    corner(card, 9)
    stroke(card, C.divider, 1)

    local k = Instance.new("TextLabel", card)
    k.Size                  = UDim2.new(1, -16, 0, 20)
    k.Position              = UDim2.new(0, 12, 0, 8)
    k.BackgroundTransparency = 1
    k.Text                  = key
    k.TextColor3            = C.subtext
    k.Font                  = Enum.Font.Gotham
    k.TextSize              = 10
    k.TextXAlignment        = Enum.TextXAlignment.Left

    local v = Instance.new("TextLabel", card)
    v.Size                  = UDim2.new(1, -16, 0, 20)
    v.Position              = UDim2.new(0, 12, 0, 26)
    v.BackgroundTransparency = 1
    v.Text                  = value
    v.TextColor3            = C.white
    v.Font                  = Enum.Font.GothamBold
    v.TextSize              = 13
    v.TextXAlignment        = Enum.TextXAlignment.Left

    return card
end

sectionLabel(infoPage, "SCRIPT", 0)
infoCard(infoPage, 1,  "Game",    "Be a Youtuber")
infoCard(infoPage, 2,  "Version", "v2.6  â€”  Ultimate Edition")
infoCard(infoPage, 3,  "Hub",     "LunaMoon Hub")
infoCard(infoPage, 4,  "Credits", "noxis.lua")

sectionLabel(infoPage, "SUPPORT", 10)
infoCard(infoPage, 11, "Shortcut", "F8 Key or Click Logo")

-- ============================================================
--  MINIMIZE LOGIC
-- ============================================================
local minimized = false
MinBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    MinBtn.Text = minimized and "+" or "-"
    if minimized then
        TopPatch.Visible = false
        tween(Win, { Size = UDim2.new(0, 560, 0, 46) }, 0.3)
        task.delay(0.15, function() Body.Visible = false end)
    else
        Body.Visible = true
        TopPatch.Visible = true
        tween(Win, { Size = UDim2.new(0, 560, 0, 400) }, 0.3)
    end
end)

-- ============================================================
--  FLOATING BUTTON (OPEN UI)
-- ============================================================
local OpenBtn = Instance.new("ImageButton", ScreenGui)
OpenBtn.Name             = "OpenBtn"
OpenBtn.Size             = UDim2.new(0, 46, 0, 46)
OpenBtn.Position         = UDim2.new(0, 20, 0.5, -23)
OpenBtn.BackgroundColor3 = C.sidebar
OpenBtn.Image            = "rbxassetid://129928619995803"
OpenBtn.ImageColor3      = C.accent
OpenBtn.Visible          = false
OpenBtn.Active           = true
OpenBtn.Draggable        = true
corner(OpenBtn, 12)
animatedStroke(OpenBtn, 1.5)
applyPadding(OpenBtn, 8, 8, 8, 8)

local function toggleUI(forceState)
    local isVisible = forceState
    if isVisible == nil then 
        isVisible = not Win.Visible 
    end
    
    Win.Visible = isVisible
    OpenBtn.Visible = not isVisible
end

-- Open/Close UI Connections
CloseBtn.MouseButton1Click:Connect(function() toggleUI(false) end)
OpenBtn.MouseButton1Click:Connect(function() toggleUI(true) end)

UserInputService.InputBegan:Connect(function(input, gpe)
    if not gpe and input.KeyCode == Enum.KeyCode.F8 then
        toggleUI()
    end
end)

-- ============================================================
--  STARTUP
-- ============================================================
switchTab("Automation")

print("[LunaMoonHub v2.6] All modules loaded successfully âœ“")
